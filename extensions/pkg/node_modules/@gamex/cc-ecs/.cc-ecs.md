# ECS模块

## 前置条件
[游戏引擎](https://www.cocos.com/en/creator-download)
[开发框架](https://github.com/a1076559139/cocos-creator-frame-3d)

## 使用案例
```TS
import {ecs, tween, timer, ecsclass, filter, EcsComponent, EcsSingleton, EcsEntity, EcsSystem} from 'db://pkg/@gamex/cc-ecs';

// 实体
class MyEntity extends EcsEntity {
    // 允许回收
    static allowRecycling = true;
}

// 组件
@ecsclass('MyComponent')
class MyComponent extends EcsComponent<MyEntity> {
    // 允许回收
    static allowRecycling = true;
    public count = 0;

    // 因为开启回收，触发删除后重制数据
    protected onRemove(){
        this.count = 0;
    }
}

// 单例组件
@ecsclass('MySingleton')
class MySingleton extends EcsSingleton{
    
}

// 系统
class MySystem extends EcsSystem {
    private filter = filter.all(MyComponent);
    execute(dt: number) {
        // 查询所有符合条件的实体
        this.query(this.filter).forEach(entity => {
            console.log(entity.get(MyComponent).count);
        })

        // 添加timer
        this.timer.add(
            timer(() => {console.log('timer'); })
        );
        
        // 添加tween
        const comp = this.find(this.filter, MyComponent);
        this.tween.add(
            tween(comp).to(1, {count: 100})
        );

        // 驱动timer和tween
        this.timer.step(dt);
        this.tween.step(dt);
    }
}

// 创建实体并添加组件
const entity = ecs.createEntity(MyEntity, node);
entity.add(MyComponent);

// 单例组件，不依附于实体而存在，一般用于存储全局数据
ecs.getSingleton(MySingleton);

// 将系统注册到ecs中
ecs.addSystem(MySystem);
// 驱动系统运行
ecs.execute(dt);
```
